#!/bin/sh

# Helper script for installing firmware update packages
#
# Usage:
#   fwupdate.sh <archive.fw> [arguments to update script]
#
# Examples:
#   Get a list of options:
#     fwupdate archive.fw -?
#
#   Install the update on an attached SDCard on your PC.
#   This installs everything.
#     fwupdate archive.fw -d /dev/sdc -f
#
#   Install the update when running on the target. This
#   only installs the new rootfs and is generally what
#   you want to do for on-device upgrades.
#     fwupdate archive.fw -d /dev/mmcblock0

set -e

if [ $# -lt 1 ]
then
	echo "usage: $0 <archive.fw>"
	exit 1
fi

archive="$1"
shift

#set -o pipefail
unzip -p $archive install.sh | sh -s - -a $archive $@

